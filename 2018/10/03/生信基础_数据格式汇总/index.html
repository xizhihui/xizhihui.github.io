<!DOCTYPE html>
<html>
<head>
	<title>XZH's Notes</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="author" content="xizhihui" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="stylesheet" type="text/css" href="/statics/reset.css">
	<link rel="stylesheet" type="text/css" href="/statics/header_footer.css"></link>
	<link rel="stylesheet" type="text/css" href="/statics/default.css">
	<link rel="stylesheet" type="text/css" href="/statics/main.css">
</head>
<body>
	<header class="Header">
		<nav>
			<h3>XZH</h3>
			<ul>
				<li><a href="/index.html#Timeline">Timeline</a></li><li><a href="/index.html#Category">Category</a></li><li><a href="/index.html#Tags">Tags</a></li><li><a href="/index.html#About">About</a></li>
			</ul>
		</nav>
	</header>
	<div class="Motto">
		<h2>XZH's Notes</h2>
		<h4>The future comes for you ~ ~ ~</h4>
	</div>

	<main>
		<nav id="table"></nav>
		<content id="content" class="content">
			<h2 id="_1">第三节 生信数据格式汇总</h2>
<h2 id="fastqfasta">一、Fastq和Fasta格式</h2>
<h3 id="11-fasta">1.1 FASTA</h3>
<p>Fasta格式是存储序列相关信息的一种格式，包含两个部分。Fasta第一个部分是以“&gt;”开头的一行。以序列来源、序列ID为值对，用竖线进行分隔。在最后竖线处，以空格分开，添加序列相关描述。第二部分是序列的详细信息，多数为序列组成。其基本形式如下.</p>
<div class="codehilite"><pre><span></span><span class="o">&gt;</span>ENSEMBL<span class="o">|</span>geneID<span class="o">|</span>source2<span class="o">|</span>geneID description
序列ATCG
</pre></div>


<div class="codehilite"><pre><span></span><span class="o">&gt;</span>gi<span class="o">|</span><span class="m">13650073</span><span class="o">|</span>gb<span class="o">|</span>AF349571.1<span class="o">|</span> Homo sapiens hemoglobin alpha<span class="m">-1</span> globin chain <span class="p">(</span>HBA1<span class="p">)</span> mRNA<span class="p">,</span> complete cds
ATCGATCGATCGATCG...

<span class="c1"># gi|13650073 基因ID</span>
<span class="c1"># gb|AF349571.1 genebank编号</span>
<span class="c1"># Homo sapiens hemoglobin alpha-1 globin chain (HBA1) 基因名称</span>
<span class="c1"># mRNA, complete cds 序列类型</span>
</pre></div>


<h3 id="12-fastq">1.2 FASTQ</h3>
<p>Fastq格式是Fasta的一种补充集合格式。由于Fasta格式文件一般不包含序列中碱基质量信息，往往需要额外的一个质量文件。而Fastq格式文件则将这二者综合起来；一个Fastq文件格式亚单位由四行构成。第一行是基本序列信息，由“@”符号开头提示。第二行是序列碱基组成字符。第三行是额外补充信息，由“+”开头提示。第四行是测序碱基的质量值，与第二行的每个字符一一相对应。其基本形式如下：</p>
<div class="codehilite"><pre><span></span>line1<span class="o">:</span>  <span class="o">@</span><span class="kp">sequence</span><span class="o">-</span>ID description
line2<span class="o">:</span>  ATCGATCG...
line3<span class="o">:</span>  <span class="o">+</span>description
line4<span class="o">:</span>  Qualityvalue
</pre></div>


<div class="codehilite"><pre><span></span><span class="o">@</span>ST<span class="o">-</span>E00126<span class="o">:</span><span class="m">128</span><span class="o">:</span>HJFLHCCXX<span class="o">:</span><span class="m">2</span><span class="o">:</span><span class="m">1101</span><span class="o">:</span><span class="m">7405</span><span class="o">:</span><span class="m">1133</span>
ATCGATCG…<span class="m">..</span>
<span class="o">+</span>
Aliclisjlgij922jida

<span class="c1"># @，开始的标记符号;</span>
<span class="c1"># ST-E00126:128:HJFLHCCXX，测序仪唯一的设备名称;  </span>
<span class="c1"># 2，lane的编号;           </span>
<span class="c1"># 1101，tail的坐标;</span>
<span class="c1"># 7405，在tail中的X坐标;</span>
<span class="c1"># 1133，在tail中的Y坐标</span>
</pre></div>


<h3 id="13-phred">1.3 phred质量值</h3>
<p>由于在测序过程中，信号有强弱，这就导致测序所得碱基与真实碱基之间有偏差的可能；为了衡量这种与实际之间的差异，就出现了phred质量值。Phred质量值指代在某个位点的碱基测序出现错误的可能性（机率）。例如某个碱基测序的错误机率为0.001，那么对该值取log对数值的十倍负值，则可得到phred质量值，如此，质量值越大，代表者测序出错的几率越小。计算公式如下：</p>
<div class="codehilite"><pre><span></span>Qphred，<span class="m">0.001</span><span class="o">=</span><span class="m">-10</span><span class="o">*</span><span class="kp">log10</span><span class="p">(</span><span class="m">0.001</span><span class="p">)</span><span class="o">=</span><span class="m">30</span>
</pre></div>


<p>但是，每次测序存储数据的内存占用很大，又要额外的内存存储诸如30一类的2位数数字；因此为了简化存储，便将这类质量值与ASCLⅡ对应的字符一一对应起来，实现单个字符显示质量值。在现有版本中，由于fastq格式文件单位首行以@符号开头，其ASCII值为33；当有碱基的质量值为33时，其质量值字符就与首行提示符@相冲突。为了避免这种冲突，便将实际质量值加上33作为ASCII码对应字符，这就是Phred33。如果实际质量值加上64则是Phred64。
通过测序所得的原始下机数据因为要包含测序质量信息，这类数据使用fastaq文件格式就更为方便；而经过拼接组装、翻译后的碱基序列、蛋白序列，并没有质量信息，使用fasta格式则较合适。</p>
<div class="codehilite"><pre><span></span>平台 | 质量值 | 具体值 | ASCII 
---|---|---|--- 
sanger | phred + 33 | 0-93 | 33-126
solexa | solexa + 64 | -5-62 | 59-126
illumina~1.8 | phred + 64 | 0-62 | 64-126
illumina1.8+ | phred + 33 | 0-94 | 32-126
</pre></div>


<h2 id="sambam">二、SAM和BAM格式</h2>
<p><a href="https://wikis.utexas.edu/display/bioiteam/Variant+calling+using+SAMtools">利用samtools进行variant calling</a>： https://wikis.utexas.edu/display/bioiteam/Variant+calling+using+SAMtools<br />
SAM是sequence alignment/map format的简称，用于存储序列比对的信息；而BAM是SAM文件的二进制格式，取自binary of SAM。该文件由两部分组成，一部分是以@开头的注释行，另一部分是比对结果部分。</p>
<div class="codehilite"><pre><span></span>注释行部分：以<span class="o">@</span>开头进行注释。如：
<span class="o">@</span>HD 说明符合标准的版本、对比序列的排列顺序
<span class="o">@</span>SQ 参考序列的说明
<span class="o">@</span>PG 使用的比对程序
<span class="o">@</span>LN 参考序列的长度

比对结果部分
column <span class="m">1</span><span class="o">:</span> query name<span class="p">,</span> 比对片段的编号
column <span class="m">2</span><span class="o">:</span> FLAG，表明比对的情况
column <span class="m">3</span>：比对上的染色体号
column <span class="m">4</span>：POS，比对上的位置
column <span class="m">5</span>：MAPQ，比对的质量
column <span class="m">6</span>：CIGAR，Concise IdiosyncraRc Gapped Alignment Report. 记录插入，删除，错配以及splice junctions（后剪切拼接的接头）
column <span class="m">7</span>：MRNM，chr，下一个片段比对上的参考序列的编号
column <span class="m">8</span>：mate pos，下一个片段比对上的位置
column <span class="m">9</span>：ISIZE，模版的长度
column <span class="m">10</span>：序列片段的序列信息，read序列
column <span class="m">11</span>：read质量
column <span class="m">12</span>：程序用的标记，可选区域

<span class="c1"># sam to bam</span>
samtools view <span class="o">-</span>bS input.sam <span class="o">&gt;</span> output.bam
</pre></div>


<p><img alt="SAM records" src="https://s1.ax1x.com/2018/07/04/PEHkNV.png" /></p>
<h2 id="gtfgff">三、GTF/GFF格式</h2>
<p>GTF和GFF是用来存储基因和基因组注释信息的文件格式，共有9列信息。<br />
其中，GFF的type必需注明，attribute的名称和值要以空格分开。 <br />
GTF的attribute则是以‘=’分开。<br />
我们可以使用cufflinks、gffread、gff2gtf对二者进行转换。<br />
<a href="https://zhuanlan.zhihu.com/p/36065699">该格式文件的下载方法</a>：https://zhuanlan.zhihu.com/p/36065699</p>
<table>
<thead>
<tr>
<th>格式</th>
<th>列1</th>
<th>列2</th>
<th>列3</th>
<th>列4</th>
<th>列5</th>
<th>列6</th>
<th>列7</th>
<th>列8</th>
<th>列9</th>
</tr>
</thead>
<tbody>
<tr>
<td>GFF</td>
<td>seqID</td>
<td>source</td>
<td>type</td>
<td>start</td>
<td>end</td>
<td>score</td>
<td>strand</td>
<td>phase</td>
<td>attributes</td>
</tr>
<tr>
<td>GTF</td>
<td>seqName</td>
<td>souce</td>
<td>start</td>
<td>end</td>
<td>feature</td>
<td>score</td>
<td>strand</td>
<td>frame</td>
<td>attrbuites</td>
</tr>
</tbody>
</table>
<h2 id="bigwigwiggle">四、Bigwig/wiggle</h2>
<ul>
<li>wiggle track format(wig): http://genome.ucsc.edu/goldenPath/help/wiggle.html</li>
<li>bigwig track format(bigwig): http://genome.ucsc.edu/goldenPath/help/bigWig.html</li>
<li>bedgraph track format(bdg): http://genome.ucsc.edu/goldenPath/help/bedgraph.html</li>
</ul>
<p>wig,bigwig,bedgraph格式文件的作用是追踪参考基因组的各个区域的覆盖度,测序深度, 可以上传到UCSC的genome browser进行可视化.bigwig是wig的二进制版本. 下方是一个wig文件的示例,它只会在前面标明当前染色体一次(chrom=chr1), 测序深度统计的区间间隔是10.<br />
bedgraph是对bed文件的拓展, 是只有4列的BED格式,不过有额外的属性关键字.值得注意的是, bedgraph文件里面的染色体坐标是从0开始的, 坐标终点是个开区间.  </p>
<p>对于wig,bw,bdg,gtf,gff等各种文件的转换,可以使用这个网站(http://barcwiki.wi.mit.edu/wiki/SOPs/coordinates)的脚本.如果是SE的比对文件,可以直接使用下面的命令. 在UCSC的ftp站点中也可以直接下载这类格式的文件.</p>
<div class="codehilite"><pre><span></span><span class="c1"># sample.wig</span>
track type<span class="o">=</span>print wiggle_0 name<span class="o">=</span>hek  description<span class="o">=</span>hek
variableStep chrom<span class="o">=</span>chr1 span<span class="o">=</span><span class="m">10</span>
<span class="m">10008</span>    <span class="m">7</span>
<span class="m">10018</span>    <span class="m">14</span>
<span class="m">10028</span>    <span class="m">27</span>

<span class="c1"># sample.bedgraph</span>
track type<span class="o">=</span>bedGraph name<span class="o">=</span><span class="s">&quot;hek_treat_all&quot;</span> description<span class="o">=</span><span class="s">&quot;Extended tag pileup from MACS version 1.4.2 20120305&quot;</span>
chr1    <span class="m">9997</span>    <span class="m">9999</span>    <span class="m">1</span>
chr1    <span class="m">9999</span>    <span class="m">10000</span>   <span class="m">2</span>
chr1    <span class="m">10000</span>   <span class="m">10001</span>   <span class="m">4</span>
</pre></div>


<h3 id="wigbigwigbdg">wig,bigwig,bdg的常见转换工具</h3>
<div class="codehilite"><pre><span></span><span class="c1"># SE.bam to bdg</span>
macs2 pileup <span class="o">--</span>extsize <span class="m">200</span> <span class="o">-</span>i sample.bam <span class="o">-</span>o sample.bdg

bigwigToBedGraph
bigWigToWig
bigWigSummary
bigWigAverageOverBed
bigWigInfo
</pre></div>


<h2 id="vcf">五、VCF格式</h2>
<p>vcf(variant calling format)格式文件用来存储与突变相关的信息。它由两部分组成。<br />
第一部分：头行（vcf header）,以##开头，有文件格式，使用软件信息，参考序列信息，重叠群（contig）的相关信息（拼接时reads之间的overlap区域）等等。<br />
第二部分：具体的突变信息，共有==八列==。</p>
<div class="codehilite"><pre><span></span><span class="m">1</span> CHROM     染色体名称（chromosome）<span class="p">,</span>哪一个参考序列上发现了突变，如MAL1
<span class="m">2</span> POS       参考基因组上发生突变的位置，以<span class="m">1</span>开始计算，如<span class="m">265854</span>
<span class="m">3</span> ID        突变的ID<span class="p">,</span>如果在dbSNP中有该SNP的id<span class="p">,</span>则给出<span class="p">;</span>否则为<span class="s">&#39;.&#39;</span><span class="p">,</span>表示是新的variant
<span class="m">4</span> REF       参考序列上的碱基<span class="p">,</span> 必需是ATCGN之一<span class="p">,</span>N表示不确定.
<span class="m">5</span> ALT       与参考碱基相比<span class="p">,</span>发生突变的碱基<span class="m">.</span>如REF是G<span class="p">,</span> 而这里是C
<span class="m">6</span> QUAL      发生突变的碱基质量<span class="p">,</span> 质量越高则是真实variant的可能性越大.如6.2.
<span class="m">7</span> FILTER    过滤后的状态<span class="p">,</span>如果variant通过GATK的过滤<span class="p">,</span>值为pass.
<span class="m">8</span> INFO      variant的详细信息

详细信息含：
DP          该位置的read覆盖度<span class="p">(</span>reads有经过过滤<span class="p">)</span>
MQ          比对到该位置reads质量值的均方值<span class="p">(</span>RMS Mapping Quality<span class="p">)</span>
FQ          质量值<span class="p">,</span>表征所有样本相似的可能性
AF1         AF1<span class="o">/</span><span class="m">2</span>表示等位基因发生频率的可能性评估<span class="p">,</span><span class="m">1</span>为第一个等位基因的频率
AC1         AC1<span class="o">/</span><span class="m">2</span>表示等位基因出现数目的可能性评估
AN          等位基因的总数目
IS          插入缺失或部分插入缺失的reads所允许的最大数目
INDEL       表明这个variant是插入缺失
QBD         测序深度对碱基质量的影响
其他<span class="p">(</span>http<span class="o">://</span>www.bio<span class="o">-</span>info<span class="o">-</span>trainee.com<span class="o">/</span><span class="m">863.</span>html<span class="p">)</span>
</pre></div>
		</content>

	</main>
	<footer>
		<p> Powered by xizhihui </p>
		<p> Thanks to <a href="https://www.hifreud.com/">hifreud</a> the theme is learned from his site. </p>
	</footer>

<script type="text/javascript" src="/js/index.json"></script>
<script type="text/javascript" src="/js/category.json"></script>
<script type="text/javascript" src="/js/tags.json"></script>
<script type="text/javascript" src="/js/about.json"></script>
<script type="text/javascript" src="/js/index.js"></script>
<script type="text/javascript">
	// listen to click event on navigator in header
	// document
	// 	.querySelector("div#head_right ul")
	// 	.addEventListener("click", change_page)
	var table = [['h2', '_1', '第三节 生信数据格式汇总'], ['h2', 'fastqfasta', '一、Fastq和Fasta格式'], ['h3', '11-fasta', '1.1 FASTA'], ['h3', '12-fastq', '1.2 FASTQ'], ['h3', '13-phred', '1.3 phred质量值'], ['h2', 'sambam', '二、SAM和BAM格式'], ['h2', 'gtfgff', '三、GTF/GFF格式'], ['h2', 'bigwigwiggle', '四、Bigwig/wiggle'], ['h3', 'wigbigwigbdg', 'wig,bigwig,bdg的常见转换工具'], ['h2', 'vcf', '五、VCF格式']]
	var html = format_article_table(table)
	var table_ele = document.querySelector("main #table")
	table_ele.innerHTML = html
	// window.onload = evt => resize_nav(table_ele)
	adaption(document, window)

</script>
</body>
</html>
---
title: 生信基础 各种数据的下载
date: 2018-10-12
toc: true
categories: Bioinformatics
tags: 生信基础
---

## 三大数据库版本对应情况
NCBI    |  UCSC      |  Ensemble
---|---|---
GRCh36  | hg18       |  ENSEMBL release_52
GRCh37  | hg19       | ENSEMBL release_59/61/64/68/69/75
GRCh38  | hg38       |  ENSEMBL release_76/77/78/80/81/82

<!--more-->

## SRA/SRR数据
上[EBI网站](https://www.ebi.ac.uk/)查找数据的SRR,然后使用aspera下载fastq.gz原始数据

```bash
# .openssh不可用则改用.putty的文件
# 注意nohup & 之前的那个点".", 是给ascp用的
ascp=~/.aspera/connect/bin/ascp
ssh_key=~/.aspera/connect/etc/asperaweb_id_dsa.openssh
nohup $ascp -P 33001 -i $ssh_key \
    era-fasp@fasp.sra.ebi.ac.uk:/vol1/fastq/SRR404/000/SRR4041970/SRR4041970_1.fastq.gz . &
    
# 数据库对应的地址
NCBI: anonftp@ftp-private.ncbi.nlm.nih.gov:genomes/
EBI: era-fasp@fasp.sra.ebi.ac.uk:/vol1/

# sra-tools::prefetch accession
```

## GEO数据

使用GEOquery包进行下载.


```r
# 使用GDS858的ID下载
GDS = getGEO('GDS858', destdir='.')
expr_matrix = Table(GDS)	#得到表达矩阵
Des_info = Meta(GDS)		#得到描述信息(metadata)

# 使用GSE1009的ID下载
# 返回的是含expressionSet对象的list
genes = geneNames(GSE[[1]])		# 得到gene名, geneNames是biobase包里面的
samples = sampleNames(GSE[[1]])	# 得到样品名
pdata = pData(GSE[[1]])			# 得到描述信息(metadata)
expr_matrix = exprs(GSE[[1]])	# 得到表达矩阵

# GPL16699的ID下载
Des_info = Meta(GPL)		# 得到描述信息
Annotation = Table(GPL)		# 得到芯片注释信息(geneID-probeID)

# 下载原始数据
rawdata = getGEOSuppFiles(GSE1009)
```
## TCGA

> [xenabrowser](https://xenabrowser.net/datapages/)整合了TCGA的数据,可以直接选择下载

先从TCGA选择数据,然后下载对应的manifest进行下载.


```bash
TCGA：https://cancergenome.nih.gov/
gdc-client.exe download -m gdc_manifest_20180516_053841.txt -d tcgadata
```

## 参考基因组及注释
> 如果浏览器无法访问,将ftp:改成http:即可  

+ UCSC Table Browser：  http://genome.ucsc.edu/cgi-bin/hgTables?hgsid=679534527_eRMIpVLpdUvIprCRZP6InFABs6gX
+ NCBI ftp：            ftp://ftp.ncbi.nlm.nih.gov/  
+ EMBL ftp：            ftp://ftp.ensembl.org/pub/,
                        ftp://ftp.ensembl.org/pub/release-86/gtf/homo_sapiens
+ GCD:                  http://www.gencodegenes.org/
+ 指定基因(batch entrezhttps)://www.ncbi.nlm.nih.gov/sites/batchentrez
+ 植物参考基因组(phytozome):https://phytozome.jgi.doe.gov/pz/portal.html
+ 小鼠基因组(MGI):      http://www.informatics.jax.org/
+ 拟南芥(ZFIN):         https://zfin.org/
+ DDBJ
+ Gramene


```bash
# entrez 下载
# 1. 准备好accession或identifier文件
# 2. 选择数据类型
# 3. 上传准备好的文件, 点击Retrieve按钮获取即可
```

### 其他
1. 水稻的参考基因组和注释

+ 参考基因组: http://rice.plantbiology.msu.edu/pub/data/Eukaryotic_Projects/o_sativa/annotation_dbs/pseudomolecules/version_7.0/all.dir/all.con
+ 注释: http://rice.plantbiology.msu.edu/pub/data/Eukaryotic_Projects/o_sativa/annotation_dbs/pseudomolecules/version_7.0/all.dir/all.gff3

2. 拟南芥

+ 参考转录组,cDNA  
ftp://ftp.ensemblgenomes.org/pub/plants/release-28/fasta/arabidopsis_thaliana/cdna/Arabidopsis_thaliana.TAIR10.28.cdna.all.fa.gz
+ 参考基因组,genome  
ftp://ftp.ensemblgenomes.org/pub/plants/release-28/fasta/arabidopsis_thaliana/dna/Arabidopsis_thaliana.TAIR10.28.dna.genome.fa.gz
+ 注释,gff3  
ftp://ftp.ensemblgenomes.org/pub/plants/release-28/gff3/arabidopsis_thaliana/Arabidopsis_thaliana.TAIR10.28.gff3.gz  
+ 注释,gtf  
ftp://ftp.ensemblgenomes.org/pub/plants/release-28/gtf/arabidopsis_thaliana/Arabidopsis_thaliana.TAIR10.28.gtf.gz

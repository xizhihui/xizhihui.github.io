<!DOCTYPE html>
<html>
<head>
	<title>XZH's Notes</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="author" content="xizhihui" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="stylesheet" type="text/css" href="/statics/reset.css">
	<link rel="stylesheet" type="text/css" href="/statics/header_footer.css"></link>
	<link rel="stylesheet" type="text/css" href="/statics/default.css">
	<link rel="stylesheet" type="text/css" href="/statics/main.css">
</head>
<body>
	<header class="Header">
		<nav>
			<h3>XZH</h3>
			<ul>
				<li><a href="/index.html#Timeline">Timeline</a></li><li><a href="/index.html#Category">Category</a></li><li><a href="/index.html#Tags">Tags</a></li><li><a href="/index.html#About">About</a></li>
			</ul>
		</nav>
	</header>
	<div class="Motto">
		<h2>XZH's Notes</h2>
		<h4>The future comes for you ~ ~ ~</h4>
	</div>

	<main>
		<nav id="table"></nav>
		<content id="content" class="content">
			<h1 id="unqiue">获取比对结果的unqiue比对</h1>
<h2 id="1samtophathisat2">1.Sam文件各标签含义（tophat/hisat2)</h2>
<p><code>NH:i:&lt;N&gt;</code>: N=1时 为unique。常用于tophat/hisat2产生的sam文件unique read筛选。</p>
<p><code>CC:Z</code>: 当为‘=’为map到同一条基因上，一般在map基因组时由于内含子存在而容易出现，他只代表两种不同的方式，计数时应记为1。此处一般为其他基因的名字。CP:i 和HI：i标签为map到第i条基因及起始位置。</p>
<p><code>YT:Z:S</code> 代表的含义与bowtie产生的sam也不同。具体还未知！其他标签AS，XN,XM,XO,XG,NM,MD等如下图可以看出都相同。</p>
<blockquote>
<p>对于tophat/hisat2比对产生的sam文件我们可以直接筛选NH标签。</p>
</blockquote>
<div class="codehilite"><pre><span></span>grep‘NH:i:1’ out.sam &gt;unique.sam
</pre></div>


<h2 id="2sambowtie2">2.Sam文件各标签含义（bowtie2)</h2>
<p><code>AS:i:&lt;N&gt;</code> Alignmentscore.可以为负的，在local下可以为正的。 只有当Align≥1 time才出现</p>
<p><code>XS:i:&lt;N&gt;</code> Alignmentscorefor second-best alignment. 当Align&gt;1 time出现</p>
<p><code>YS:i:&lt;N&gt;</code> Alignmentscorefor opposite mate in the paired-end alignment. 当该read是双末端测序中的另一条时出现</p>
<p><code>XN:i:&lt;N&gt;</code> Thenumber of ambiguous bases in the reference covering this alignment.（推测是指不知道错配发生在哪个位置，推测是针对于**和缺失，待查证）</p>
<p><code>XM:i:s</code> 错配碱基的数目</p>
<p><code>XO:i:&lt;N&gt;</code> Thenumberof gap opens(针对于比对中的**和缺失)</p>
<p><code>XG:i:&lt;N&gt;</code> Thenumberof gap extensions(针对于比对中的**和缺失延伸数目)</p>
<p><code>NM:i:&lt;N&gt;</code> Theeditdistance。（edits:**/缺失/替换数目)</p>
<p><code>YF:Z:</code>s该reads被过滤掉的原因。可能为LN(错配数太多，待查证)、NS(read中包含N或者．)、SC(match bonus低于设定的阈值)、QC(failing quality control，待证)</p>
<p><code>YT:Z:s</code> 值为UU表示不是pair中一部分、CP是pair且可以完美匹配、DP是pair但不能很好的匹配、UP是pair但是无法比对到参考序列上。</p>
<p><code>MD:Z:s</code>比对上的错配碱基的字符串表示。</p>
<blockquote>
<p>由于bowtie2产生的sam文件并没有NH标签，所以提取uniqueread可能比较麻烦。首先提取“AS”标签表示能比对上的read（&gt;=1 time），然后利用grep反正则表达式过滤掉XS标签得到我们需要的unique read。</p>
</blockquote>
<div class="codehilite"><pre><span></span>grep “AS:” aligned.sam <span class="p">|</span> grep –v “XS:” &gt;unique_alignments.sam
</pre></div>


<p>对于双端测序用bowtie2比对筛选unique concordant pair时则需要在上一步的基础上增加如下命令：</p>
<div class="codehilite"><pre><span></span>grep ‘YT:Z:CP’ unique.sam&gt;pair-end_unique.sam
</pre></div>


<h2 id="3bwaunique">3.Bwa获取unique</h2>
<div class="codehilite"><pre><span></span>samtools view bwa.bam <span class="p">|</span> grep <span class="s2">&quot;XT:A:U&quot;</span>
</pre></div>
		</content>

	</main>
	<footer>
		<p> Powered by xizhihui </p>
		<p> Thanks to <a href="https://www.hifreud.com/">hifreud</a> the theme is learned from his site. </p>
	</footer>

<script type="text/javascript" src="/js/index.json"></script>
<script type="text/javascript" src="/js/category.json"></script>
<script type="text/javascript" src="/js/tags.json"></script>
<script type="text/javascript" src="/js/about.json"></script>
<script type="text/javascript" src="/js/index.js"></script>
<script type="text/javascript">
	// listen to click event on navigator in header
	// document
	// 	.querySelector("div#head_right ul")
	// 	.addEventListener("click", change_page)
	var table = [['h2', '1samtophathisat2', '1.Sam文件各标签含义（tophat/hisat2)'], ['h2', '2sambowtie2', '2.Sam文件各标签含义（bowtie2)'], ['h2', '3bwaunique', '3.Bwa获取unique']]
	var html = format_article_table(table)
	var table_ele = document.querySelector("main #table")
	table_ele.innerHTML = html
	// window.onload = evt => resize_nav(table_ele)
	adaption(document, window)

</script>
</body>
</html>
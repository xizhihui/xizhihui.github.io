<!DOCTYPE html>
<html>
<head>
	<title>XZH's Notes</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="author" content="xizhihui" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="stylesheet" type="text/css" href="/statics/reset.css">
	<link rel="stylesheet" type="text/css" href="/statics/header_footer.css"></link>
	<link rel="stylesheet" type="text/css" href="/statics/default.css">
	<link rel="stylesheet" type="text/css" href="/statics/main.css">
</head>
<body>
	<header class="Header">
		<nav>
			<h3>XZH</h3>
			<ul>
				<li><a href="/index.html#Timeline">Timeline</a></li><li><a href="/index.html#Category">Category</a></li><li><a href="/index.html#Tags">Tags</a></li><li><a href="/index.html#About">About</a></li>
			</ul>
		</nav>
	</header>
	<div class="Motto">
		<h2>XZH's Notes</h2>
		<h4>The future comes for you ~ ~ ~</h4>
	</div>

	<main>
		<nav id="table"></nav>
		<content id="content" class="content">
			<h2 id="wgcna">加权基因共表达网络分析(WGCNA)</h2>
<h3 id="_1">一、总述</h3>
<p>在拿到高通量测序数据以后(特别是基因表达数据),通常要分析基因与表型之间的相关性,以探究基因对表型所起关键的调节功能；而加权基因共表达网络分析(Weighted Gene Coexpression Network Analysis)就是其中比较实用的一种分析方法。那么,什么是加权基因共表达网络分析呢？要了解这个,我们需要对以下前提有所了解。</p>
<ul>
<li>功能相关的基因,其表达水平/表达模式也基本上是相似的</li>
<li>表达水平高度相关的基因具有潜在的共有调控机制或参与相似的生物学过程</li>
<li>如果得到某个表达模式中涉及到许多基因,其中有些基因是已知的,基于上面两点,那么就可以通过该已知基因的功能推测未知基因的功能</li>
</ul>
<p>根据上面三点,我们就要得到有许多基因涉及的表达模式,而这个可以通过对基因的表达数据进行聚类得到.讲到这里,WGCNA实质上也是一种聚类方法.而在WGCNA之前,现在也在使用的另一种基因与表型的分析方法,那就是基因共表达网络分析.而WGCNA相较于后者来讲,有何优势?</p>
<h4 id="11-gcnawgcna">1.1 相较于GCNA,WGCNA的优势</h4>
<ol>
<li>对Pearson coefficient的绝对值取β次幂构建相关性<br />
这样做的优势在于,如果两个基因相关性较高的话,取幂后相关性更高;相关性较低,取幂后相关性更低.如此,就更加凸显两个基因的相关性.</li>
<li>相关性阈值的软设定<br />
使用相关性软阈值设定的方法,进一步涵盖潜在的显著相关性基因;而非一刀切,因为你无法判定0.89与0.90之间,前者就相关性不显著,后者就显著相关.如果一刀切的话,你的结果则依据这个相关性阈值的设定不同,而显著不同</li>
<li>以TOM进一步表征基因的相关性<br />
在基因两两相关而构建的网络（图）中，通过判断两个基因与其他基因相关性的相似程度来确定这两个基因的实际相关性（topological overlap），以此聚类得出的分组更符合前面所述的前提。</li>
</ol>
<h4 id="12-wgcna">1.2 相较于差异分析,WGCNA优势</h4>
<ul>
<li>从更高层次理解基因表达与表型之间的因果关系<br />
相较于简单比较不同处理中基因表达的差异，WGCNA立足于基因模块（多个基因）的共有效应，更加符合实际情况，因为生命活动就是多中因素共同调节的结果。</li>
</ul>
<h4 id="13">1.3 基本术语</h4>
<table>
<thead>
<tr>
<th>术语</th>
<th>解析</th>
</tr>
</thead>
<tbody>
<tr>
<td>共表达网络(co-expression network)</td>
<td>无向的、加权的表达网络。无符号的a(i,j) =</td>
</tr>
<tr>
<td>模块(module)</td>
<td>高度相关的基因集</td>
</tr>
<tr>
<td>连接性(connectivity)</td>
<td>网络中某个基因与其他基因连接值的总和</td>
</tr>
<tr>
<td>模块内部连接性(intramodular connectivity)</td>
<td>模块中某个基因与同模块其他基因的连接值总和</td>
</tr>
<tr>
<td>模块特征(module eigengene)</td>
<td>给定模块的第一个主成分</td>
</tr>
<tr>
<td>特征显著性(eigengene significance)</td>
<td>模块与表型之间的相关系数</td>
</tr>
<tr>
<td>模块关系(基于模块特征的连接性)</td>
<td>给定模块的模块特征与基因表达的相关性</td>
</tr>
<tr>
<td>关键基因(hub gene)</td>
<td>给定模块中具有较大连接性的基因</td>
</tr>
<tr>
<td>基因显著性(gene significance)</td>
<td>基因表达的显著性(-log(p-value))</td>
</tr>
<tr>
<td>模块显著性(module significant)</td>
<td>给定模块中所有基因显著性的绝对值的平均值</td>
</tr>
</tbody>
</table>
<h4 id="14">1.4 基本过程</h4>
<ol>
<li>计算基因的相关性(Pearson correlation的β次幂，connectivity, K)</li>
<li>依据connectivity计算两两基因的topological overlap（relative connectivity）</li>
<li>根据拓扑重叠值构建基因表达网络</li>
<li>对此进行层次聚类，确定共表达模块（表达模式）</li>
<li>选取感兴趣的模块进行后续分析：模块的功能富集、模块与性状的相关性、模块与样本间的相关系数</li>
<li>挖掘模块的关键信息：寻找模块核心基因（hub gene)、预测基因功能</li>
</ol>
<h3 id="_2">二、分析过程</h3>
<h3 id="21">2.1 导入数据、预处理</h3>
<p>这里主要有两个目的，一个是检测数据集是否都满足WGCNA的要求，二是排除离群值，后者需要你根据数据产生的聚类树，选择合适的cutHeight来去除离群值。</p>
<div class="codehilite"><pre><span></span>expr <span class="o">=</span> read.table<span class="p">(</span><span class="s">&#39;./clean_data/expr_matrix.txt&#39;</span><span class="p">)</span>
gsg <span class="o">=</span> goodSamplesGenes<span class="p">(</span>expr<span class="p">)</span>
<span class="kr">if</span> <span class="p">(</span><span class="o">!</span>gsg<span class="o">$</span>allOK<span class="p">)</span> expr <span class="o">=</span> expr<span class="p">[</span>gsg<span class="o">$</span>goodSamples<span class="p">,</span> gsg<span class="o">$</span>goodGenes<span class="p">]</span>
sampleTree <span class="o">=</span> hclust<span class="p">(</span>as.dist<span class="p">(</span>expr<span class="p">),</span> method<span class="o">=</span><span class="s">&#39;average&#39;</span><span class="p">)</span>

<span class="c1"># [ Visualization 1 ], 根据画出的图确定cutHeight,这里假设是120</span>
pdf<span class="p">(</span>file<span class="o">=</span><span class="s">&#39;visual_01_sampleTree_with_outlier.pdf&#39;</span><span class="p">)</span>
plot<span class="p">(</span>sampleTree<span class="p">,</span>
    main<span class="o">=</span><span class="s">&#39;Sample Clustering to detect outliers&#39;</span><span class="p">,</span>
    xlab<span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> sub<span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
abline<span class="p">(</span>h<span class="o">=</span><span class="m">120</span><span class="p">,</span> col<span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
dev.off<span class="p">()</span>

cutHeight <span class="o">=</span> <span class="m">120</span>
sample_cut <span class="o">=</span> cutreeStatic<span class="p">(</span>sampleTree<span class="p">,</span> cutHeight<span class="o">=</span>cutHeight<span class="p">)</span>
expr <span class="o">=</span> expr<span class="p">[</span>sample_cut <span class="o">==</span> <span class="m">1</span><span class="p">,</span> <span class="p">]</span>
sampleTreeCut <span class="o">=</span> hclust<span class="p">(</span>as.dist<span class="p">(</span>expr<span class="p">),</span> method<span class="o">=</span><span class="s">&#39;average&#39;</span><span class="p">)</span>

<span class="c1"># [ Visualization 2], 可视化样本聚类树和表型数据</span>
traits <span class="o">=</span> read.table<span class="p">(</span>file<span class="o">=</span><span class="s">&#39;./clean_data/traits.txt&#39;</span><span class="p">)</span>
pdf<span class="p">(</span>file<span class="o">=</span><span class="s">&#39;visual_02_sampleCutTree_with_traits.pdf&#39;</span><span class="p">)</span>
colors <span class="o">=</span> numbers2colors<span class="p">(</span>traits<span class="p">)</span>
plotDendroAndColors<span class="p">(</span>sampleTreeCut<span class="p">,</span> colors<span class="p">,</span>
                    groupLabels<span class="o">=</span><span class="kp">colnames</span><span class="p">(</span>traits<span class="p">),</span>
                    main<span class="o">=</span><span class="s">&#39;Sample Clustering and traits&#39;</span><span class="p">)</span>
dev.off<span class="p">()</span>

<span class="kp">save</span><span class="p">(</span>sampleTree<span class="p">,</span> sampleTreeCut<span class="p">,</span> expr<span class="p">,</span> file<span class="o">=</span><span class="s">&#39;01_sampleTree_cut_outlier.RData&#39;</span><span class="p">)</span>
</pre></div>


<h3 id="22">2.2 获取软阈值</h3>
<p>这里的软阈值选取power significance 大于0.8或0.85,0.9的power值。一般来说都在7-10之间。如果数据较好，可以直接通过"beta=soft$EstiamteSoft"获取，否则通过可视化获取。如果数据展示出的scale-free network不太好，那就多选取一些数据，而非仅仅基于有差异表达的基因表达矩阵。</p>
<div class="codehilite"><pre><span></span>powers <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="m">20</span>
powerSigR2 <span class="o">=</span> <span class="m">0.8</span>
soft <span class="o">=</span> pickSoftThreshold<span class="p">(</span>expr<span class="p">,</span> powerVectors<span class="o">=</span>powers<span class="p">,</span> verbose<span class="o">=</span><span class="m">3</span><span class="p">)</span>
beta <span class="o">=</span> soft<span class="o">$</span>EstimateSoft

<span class="c1"># [ visualizaiton 3], 可视化软阈值的选取</span>
pdf<span class="p">(</span>file<span class="o">=</span><span class="s">&#39;visual_03_soft_pick_threshold.pdf&#39;</span><span class="p">)</span>
par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
plot<span class="p">(</span>soft<span class="o">$</span>fitIndices<span class="o">$</span>Power<span class="p">,</span>  <span class="o">-</span><span class="kp">sign</span><span class="p">(</span>soft<span class="o">$</span>fitIndices<span class="o">$</span>slope<span class="p">)</span> <span class="o">*</span> soft<span class="o">$</span>fitIndices<span class="o">$</span>SFT.R.sq<span class="p">,</span> 
     xlab<span class="o">=</span><span class="s">&#39;Soft Threshold (power)&#39;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&#39;Scale Free Topology Model Fit, signed R^2&#39;</span><span class="p">,</span> type<span class="o">=</span><span class="s">&#39;n&#39;</span><span class="p">,</span>
     main<span class="o">=</span><span class="kp">paste</span><span class="p">(</span><span class="s">&#39;Scale Independce&#39;</span><span class="p">))</span>
text<span class="p">(</span>soft<span class="o">$</span>fitIndices<span class="o">$</span>Power<span class="p">,</span> <span class="o">-</span><span class="kp">sign</span><span class="p">(</span>soft<span class="o">$</span>fitIndices<span class="o">$</span>slope<span class="p">)</span> <span class="o">*</span> soft<span class="o">$</span>fitIndices<span class="o">$</span>SFT.R.sq<span class="p">,</span>
     labels<span class="o">=</span>soft<span class="o">$</span>fitIndices<span class="o">$</span>Power<span class="p">,</span> cex<span class="o">=</span><span class="m">0.9</span><span class="p">,</span> col<span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
abline<span class="p">(</span>h<span class="o">=</span><span class="m">0.8</span><span class="p">,</span> col<span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">)</span>
plot<span class="p">(</span>soft<span class="o">$</span>fitIndices<span class="o">$</span>Power<span class="p">,</span> soft<span class="o">$</span>fitIndices<span class="o">$</span>mean.k.<span class="p">,</span>
     xlab<span class="o">=</span><span class="s">&#39;Soft Threshold (power)&#39;</span><span class="p">,</span>
     ylab<span class="o">=</span><span class="s">&#39;Mean connectivity&#39;</span><span class="p">,</span> type<span class="o">=</span><span class="s">&#39;n&#39;</span><span class="p">,</span>
     main<span class="o">=</span><span class="kp">paste</span><span class="p">(</span><span class="s">&#39;Mean connectivity&#39;</span><span class="p">))</span>
text<span class="p">(</span>soft<span class="o">$</span>fitIndices<span class="o">$</span>Power<span class="p">,</span> soft<span class="o">$</span>fitIndices<span class="o">$</span>mean.k.<span class="p">,</span>
     labels<span class="o">=</span>soft<span class="o">$</span>fitIndices<span class="o">$</span>Power<span class="p">,</span> cex<span class="o">=</span><span class="m">0.9</span><span class="p">,</span> col<span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
dev.off<span class="p">()</span>

<span class="kp">save</span><span class="p">(</span>soft<span class="p">,</span> <span class="kp">beta</span><span class="p">,</span> file<span class="o">=</span><span class="s">&#39;02_soft_threshold.RData&#39;</span><span class="p">)</span>
</pre></div>


<h3 id="23">2.3 构建网络</h3>
<p>构建网络有一步法和多步法，由于后续分析和可视化的需要，这里使用多步法。在我们通过拓扑网络计算节点距离进行聚类后，还可以根据聚类后的合并模块特征靠近的或者较小的模块。</p>
<h4 id="233">2.3.3 计算拓扑网络和内部连接性，基于此构建聚类树</h4>
<div class="codehilite"><pre><span></span>softConnect <span class="o">=</span> softConnectivity<span class="p">(</span>expr<span class="p">,</span> power<span class="o">=</span><span class="kp">beta</span><span class="p">)</span><span class="m">-1</span>
adjacency <span class="o">=</span> adjacency<span class="p">(</span>expr<span class="p">,</span> power<span class="o">=</span><span class="kp">beta</span><span class="p">)</span>
TOM <span class="o">=</span> TOMsimilarity<span class="p">(</span>adjacency<span class="p">)</span> <span class="c1"># 一步到位 TOM = TOMsimilarityFromExpr(expr,beta)</span>
dissTOM <span class="o">=</span> <span class="m">1</span> <span class="o">-</span> TOM <span class="c1"># dissTOM = TOMdist(adjacency)</span>
geneTree <span class="o">=</span> hclust<span class="p">(</span>as.dist<span class="p">(</span>dissTOM<span class="p">),</span> method<span class="o">=</span><span class="s">&#39;average&#39;</span><span class="p">)</span>
<span class="c1"># [visualization 4], 可视化拓扑图</span>
    pdf<span class="p">(</span>file<span class="o">=</span><span class="s">&#39;visual_04_scale_free_topology_plot.pdf&#39;</span><span class="p">)</span>
    scaleFreePlot<span class="p">(</span>softConnect<span class="p">,</span> truncated<span class="o">=</span><span class="bp">F</span><span class="p">,</span>
        main<span class="o">=</span><span class="kp">paste</span><span class="p">(</span><span class="s">&#39;Scale Free Topology, power=&#39;</span><span class="p">,</span> <span class="kp">beta</span><span class="p">,</span>sep<span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">))</span>
    dev.off<span class="p">()</span>
<span class="c1"># [visualization 5], 可视化拓扑网络聚类树</span>
    pdf<span class="p">(</span>file<span class="o">=</span><span class="s">&#39;visual_05_raw_gene_tree_on_dissTOM.pdf&#39;</span><span class="p">)</span>
    plot<span class="p">(</span>geneTree<span class="p">,</span> xlab<span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> sub<span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span>
            main<span class="o">=</span><span class="s">&#39;Gene Clustering on TOM-based dissimilarity&#39;</span><span class="p">,</span>
            labels<span class="o">=</span><span class="bp">F</span><span class="p">,</span> hang<span class="o">=</span><span class="m">0.04</span><span class="p">)</span>
    dev.off<span class="p">()</span>
<span class="c1"># [visualization 5.1], 可视化模块与模块之间的拓扑相异性，揭示基于拓扑重叠进行聚类的效果</span>
    pdf<span class="p">(</span>file<span class="o">=</span><span class="s">&#39;visual_05_dissTOM_between_module.pdf&#39;</span><span class="p">)</span>
    TOMplot<span class="p">(</span>dissTOM<span class="p">,</span> geneTree<span class="p">)</span>
    dev.off<span class="p">()</span>
<span class="kp">save</span><span class="p">(</span>softConnect<span class="p">,</span> adjacency<span class="p">,</span> TOM<span class="p">,</span> geneTree<span class="p">,</span> file<span class="o">=</span><span class="s">&#39;03_conn_adj_TOM.RData&#39;</span><span class="p">)</span>
<span class="kp">rm</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span>soft<span class="p">,</span> softConnect<span class="p">))</span>
</pre></div>


<h4 id="232">2.3.2 把拓扑网络聚类树进行动态修剪，产生初始模块</h4>
<div class="codehilite"><pre><span></span>minModuleSize<span class="o">=</span><span class="m">30</span>
dissTOM_cut <span class="o">=</span> cutreeDynamic<span class="p">(</span>dendro<span class="o">=</span>geneTree<span class="p">,</span> distM<span class="o">=</span>dissTOM<span class="p">,</span>
                            deepSplit<span class="o">=</span><span class="m">2</span><span class="p">,</span> pamRespectsDendro<span class="o">=</span><span class="bp">F</span><span class="p">,</span>
                            minClusterSize<span class="o">=</span>minModuleSize<span class="p">)</span>
dynamicColors <span class="o">=</span> labels2colors<span class="p">(</span>dissTOM_cut<span class="p">)</span>
<span class="c1"># [visualization 6] 可视化拓扑重叠相异性的多维尺度图(mds-plot)</span>
    pdf<span class="p">(</span>file<span class="o">=</span><span class="s">&#39;visual_06_MDS_plot_on_dissTOM_cut.pdf&#39;</span><span class="p">)</span>
    dimension_num <span class="o">=</span> <span class="m">2</span>
    cmd <span class="o">=</span> cmdscale<span class="p">(</span>as.dist<span class="p">(</span>dissTOM_cut<span class="p">),</span>dimensional_num<span class="p">)</span>
    plot<span class="p">(</span>cmd<span class="p">,</span> col<span class="o">=</span><span class="kp">as.character</span><span class="p">(</span>dynamicColors<span class="p">),</span> main<span class="o">=</span><span class="s">&#39;MDS plot&#39;</span><span class="p">,</span>
        xlab<span class="o">=</span><span class="s">&#39;Scaling Dimension 1&#39;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&#39;Scaling Dimension 2&#39;</span><span class="p">)</span>
    dev.off<span class="p">()</span>
</pre></div>


<h4 id="233_1">2.3.3 计算模块特征，合并特征相似或靠近的模块，产生最终模块</h4>
<div class="codehilite"><pre><span></span>MEs <span class="o">=</span> moduleEigengenes<span class="p">(</span>expr<span class="p">,</span> dynamicColors<span class="p">)</span><span class="o">$</span>eigengenes
dissMEs <span class="o">=</span> <span class="m">1</span> <span class="o">-</span> cor<span class="p">(</span>MEs<span class="p">)</span>
dissMEs_tree <span class="o">=</span> hclust<span class="p">(</span>as.dist<span class="p">(</span>dissMEs<span class="p">),</span> method<span class="o">=</span><span class="s">&#39;average&#39;</span><span class="p">)</span>
MEDissThreshold <span class="o">=</span> <span class="m">0.25</span>
mergedMEs <span class="o">=</span> mergeCloseModules<span class="p">(</span>expr<span class="p">,</span> dynamicColors<span class="p">,</span>
                            cutHeight<span class="o">=</span>MEDissThreshold<span class="p">,</span> verbose<span class="o">=</span><span class="m">3</span><span class="p">)</span>
<span class="c1"># [visualization 6], 可视化拓扑网络聚类树的动态修剪和合并产生的模块比较</span>
    pdf<span class="p">(</span>file<span class="o">=</span><span class="s">&#39;visual_06_raw_tree_with_dynamicCut_merge.pdf&#39;</span><span class="p">)</span>
    mergedColors <span class="o">=</span> mergedMEs<span class="o">$</span>colors
    plotDendroAndColors<span class="p">(</span>geneTree<span class="p">,</span> <span class="kp">cbind</span><span class="p">(</span>dynamicColors<span class="p">,</span> mergedColors<span class="p">),</span>
                            <span class="kt">c</span><span class="p">(</span><span class="s">&#39;Dynamic Tree cut&#39;</span><span class="p">,</span> <span class="s">&#39;Dynamic Merged&#39;</span><span class="p">),</span>
                            dendroLabels<span class="o">=</span><span class="bp">F</span><span class="p">,</span> hang<span class="o">=</span><span class="m">0.03</span><span class="p">,</span>
                            addGuide<span class="o">=</span><span class="bp">T</span><span class="p">,</span> guideHang<span class="o">=</span><span class="m">0.05</span><span class="p">,</span>
                            main<span class="o">=</span><span class="s">&#39;Gene Dendrogram with Dynamic cut &amp; Merge&#39;</span><span class="p">)</span>
    dev.off<span class="p">()</span>
<span class="c1"># [visualization 7], 可视化模块特征聚类图</span>
    pdf<span class="p">(</span>file<span class="o">=</span><span class="s">&#39;visual_07_module_eigengenes_cluster.pdf&#39;</span><span class="p">)</span>
    plot<span class="p">(</span>dissMEs_tree<span class="p">,</span> main<span class="o">=</span><span class="s">&#39;Module Eigengenes Clustering&#39;</span><span class="p">)</span>
    dev.off<span class="p">()</span>
<span class="kp">save</span><span class="p">(</span>MEs<span class="p">,</span> dissMEs_tree<span class="p">,</span> mergedMEs<span class="p">,</span> file<span class="o">=</span><span class="s">&#39;04_rawMEs_dissMEs_tree_mergedMEs.RData&#39;</span><span class="p">)</span>
<span class="kp">rm</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span>MEs<span class="p">,</span> dissMEs_tree<span class="p">))</span>
</pre></div>


<h3 id="24">2.4 关联分析</h3>
<p>从“2.1-2.3”是我们进行WGCNA的分析过程，下面是一些具体的关联分析。所谓关联分析就是把我们得到的最终的聚类模块同其他数据如表型数据计算相关性，看有哪些模块与这些数据相关，那么模块中的基因就与这些数据相关。下面是一些示例。</p>
<div class="codehilite"><pre><span></span><span class="c1"># 导入相关数据</span>
traits <span class="o">=</span> read.table<span class="p">(</span><span class="s">&#39;./clean_data/traits.txt&#39;</span><span class="p">)</span>
<span class="c1"># expr 如果不存在就load(&#39;01_sampleTree_cut_outlier.RData&#39;)</span>
<span class="c1"># mergedMEs如果不存在，就load(&#39;04_rawMEs_dissMEs_tree_mergedMEs.RData&#39;)</span>

<span class="c1"># 重新计算最终的模块特征, 并据此排序</span>
mergedColors <span class="o">=</span> mergedMEs<span class="o">$</span>colors
MEs <span class="o">=</span> moduleEigengenes<span class="p">(</span>expr<span class="p">,</span> mergedColors<span class="p">)</span><span class="o">$</span>eigengenes
MEs <span class="o">=</span> orderMEs<span class="p">(</span>MEs<span class="p">)</span>
nGenes <span class="o">=</span> <span class="kp">ncol</span><span class="p">(</span>expr<span class="p">)</span>
nSamples <span class="o">=</span> <span class="kp">nrow</span><span class="p">(</span>expr<span class="p">)</span>
modNames <span class="o">=</span> <span class="kp">substring</span><span class="p">(</span><span class="kp">names</span><span class="p">(</span>MEs<span class="p">),</span> <span class="m">3</span><span class="p">)</span>
moduleColors <span class="o">=</span> mergedColors
</pre></div>


<h4 id="241">2.4.1 模块与模块相关性</h4>
<div class="codehilite"><pre><span></span><span class="c1"># 方法一</span>
<span class="c1"># plotMEpairs(MEs)</span>
<span class="c1"># 方法二</span>
moduleModuleCor <span class="o">=</span> cor<span class="p">(</span>MEs<span class="p">,</span> MEs<span class="p">,</span> use<span class="o">=</span><span class="s">&#39;p&#39;</span><span class="p">)</span>
moduleModulePvalue <span class="o">=</span> corPvalueStudent<span class="p">(</span>moduleModuleCor<span class="p">,</span> nSamples<span class="p">)</span>
moduleModuleText <span class="o">=</span> <span class="kp">paste0</span><span class="p">(</span><span class="kp">signif</span><span class="p">(</span>moduleModuleCor<span class="p">,</span><span class="m">2</span><span class="p">),</span> <span class="s">&#39;\n(&#39;</span><span class="p">,</span>
                        <span class="kp">signif</span><span class="p">(</span>moduleModulePvalue<span class="p">,</span><span class="m">2</span><span class="p">),</span> <span class="s">&#39;)&#39;</span><span class="p">)</span>
<span class="kp">dim</span><span class="p">(</span>moduleModuleText<span class="p">)</span> <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>moduleModuleCor<span class="p">)</span>
<span class="c1"># [visualization 8] 模型与模块之间的相关性</span>
pdf<span class="p">(</span>file<span class="o">=</span><span class="s">&#39;visual_09_module_module_relationship.pdf&#39;</span><span class="p">)</span>
labeledHeatmap<span class="p">(</span>Matrix<span class="o">=</span>moduleModuleCor<span class="p">,</span> xLabels<span class="o">=</span><span class="kp">names</span><span class="p">(</span>MEs<span class="p">),</span>
                yLabels<span class="o">=</span><span class="kp">names</span><span class="p">(</span>MEs<span class="p">),</span> ySymbols<span class="o">=</span><span class="kp">names</span><span class="p">(</span>MEs<span class="p">),</span>
                xSymbols<span class="o">=</span><span class="kp">names</span><span class="p">(</span>MEs<span class="p">),</span> colorLabels<span class="o">=</span><span class="bp">F</span><span class="p">,</span>
                colors<span class="o">=</span>greenWhiteRed<span class="p">(</span><span class="m">50</span><span class="p">),</span> textMatrix<span class="o">=</span>moduleModuleText<span class="p">,</span>
                setStdMargins<span class="o">=</span><span class="bp">F</span><span class="p">,</span> zlim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span>
                main<span class="o">=</span><span class="kp">paste</span><span class="p">(</span><span class="s">&#39;Relationships between Module Eigengenes&#39;</span><span class="p">))</span>
dev.off<span class="p">()</span>
MMdata <span class="o">=</span> <span class="kp">cbind</span><span class="p">(</span>moduleModuleCor<span class="p">,</span> moduleModulePvalue<span class="p">)</span>
<span class="kp">colnames</span><span class="p">(</span>MMdata<span class="p">)</span> <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="kp">paste0</span><span class="p">(</span><span class="kp">colnames</span><span class="p">(</span>moduleModuleCor<span class="p">),</span> <span class="s">&#39;.Cor&#39;</span><span class="p">),</span>
                    <span class="kp">paste0</span><span class="p">(</span><span class="kp">colnames</span><span class="p">(</span>moduleModulePvalue<span class="p">),</span> <span class="s">&#39;.Pvalue&#39;</span><span class="p">))</span>
write.csv<span class="p">(</span>MMdata<span class="p">,</span> file<span class="o">=</span><span class="s">&#39;WGCNA_02_Modue_Module_relationship.csv&#39;</span><span class="p">)</span>
</pre></div>


<h4 id="242">2.4.2 模块与表型之间的相关性</h4>
<div class="codehilite"><pre><span></span>moduleTraitCor <span class="o">=</span> cor<span class="p">(</span>MEs<span class="p">,</span> traits<span class="p">,</span> use<span class="o">=</span><span class="s">&#39;p&#39;</span><span class="p">)</span>
moduleTraitPvalue <span class="o">=</span> corPvalueStudent<span class="p">(</span>moduleTraitCor<span class="p">,</span> nSamples<span class="p">)</span>
moduleTraitText <span class="o">=</span> <span class="kp">paste0</span><span class="p">(</span><span class="kp">signif</span><span class="p">(</span>moduleTraitCor<span class="p">,</span><span class="m">2</span><span class="p">),</span> <span class="s">&#39;\n(&#39;</span><span class="p">,</span>
                        <span class="kp">signif</span><span class="p">(</span>moduleTraitPvalue<span class="p">,</span><span class="m">2</span><span class="p">),</span> <span class="s">&#39;)&#39;</span><span class="p">)</span>
<span class="kp">dim</span><span class="p">(</span>moduleTraitText<span class="p">)</span> <span class="o">=</span> <span class="kp">dim</span><span class="p">(</span>moduleTraitCor<span class="p">)</span>
<span class="c1"># [visualization 9] 模型与表型之间的相关性</span>
pdf<span class="p">(</span>file<span class="o">=</span><span class="s">&#39;visual_08_module_traits_relationship.pdf&#39;</span><span class="p">)</span>
labeledHeatmap<span class="p">(</span>Matrix<span class="o">=</span>moduleTraitCor<span class="p">,</span> xLabels<span class="o">=</span><span class="kp">names</span><span class="p">(</span>traits<span class="p">),</span>
                yLabels<span class="o">=</span><span class="kp">names</span><span class="p">(</span>MEs<span class="p">),</span> ySymbols<span class="o">=</span><span class="kp">names</span><span class="p">(</span>MEs<span class="p">),</span>
                colorLabels<span class="o">=</span><span class="bp">F</span><span class="p">,</span> colors<span class="o">=</span>greenWhiteRed<span class="p">(</span><span class="m">50</span><span class="p">),</span>
                textMatrix<span class="o">=</span>moduleTraitText<span class="p">,</span> setStdMargins<span class="o">=</span><span class="bp">F</span><span class="p">,</span>
                zlim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span>
                main<span class="o">=</span><span class="kp">paste</span><span class="p">(</span><span class="s">&#39;Relationships between module eigengenes and traits &#39;</span><span class="p">))</span>
dev.off<span class="p">()</span>
MTdata <span class="o">=</span> <span class="kp">cbind</span><span class="p">(</span>moduleTraitCor<span class="p">,</span> moduleTraitPvalue<span class="p">)</span>
<span class="kp">colnames</span><span class="p">(</span>MTdata<span class="p">)</span> <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="kp">paste0</span><span class="p">(</span><span class="kp">colnames</span><span class="p">(</span>moduleTraitCor<span class="p">),</span> <span class="s">&#39;.Cor&#39;</span><span class="p">),</span>
                    <span class="kp">paste0</span><span class="p">(</span><span class="kp">colnames</span><span class="p">(</span>moduleTraitPvalue<span class="p">),</span> <span class="s">&#39;.Pvalue&#39;</span><span class="p">))</span>
write.csv<span class="p">(</span>MTdata<span class="p">,</span> file<span class="o">=</span><span class="s">&#39;WGCNA_01_Modue_Traits_relationship.csv&#39;</span><span class="p">)</span>
</pre></div>


<h4 id="243">2.4.3 模块与基因表达量相关性</h4>
<p>通过检测模块与表型之间的相关性，我们可以得到高度相关的模块与表型。使用这个模块和表型，获取要分析的基因。假定我们的模块是“blue”和表型是“weight”。</p>
<div class="codehilite"><pre><span></span>geneModuleCor <span class="o">=</span> cor<span class="p">(</span>expr<span class="p">,</span> MEs<span class="p">,</span> use<span class="o">=</span><span class="s">&#39;p&#39;</span><span class="p">)</span> 
<span class="c1"># modNames = substring(names(MEs), 3)</span>
geneModulePvalue <span class="o">=</span> corPvalueStudent<span class="p">(</span>geneModuleCor<span class="p">,</span> nSamples<span class="p">)</span>
<span class="kp">names</span><span class="p">(</span>geneModuleCor<span class="p">)</span> <span class="o">=</span> <span class="kp">paste</span><span class="p">(</span>modNames<span class="p">,</span> <span class="s">&#39;.Cor&#39;</span><span class="p">,</span> sep<span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
<span class="kp">names</span><span class="p">(</span>geneModulePvalue<span class="p">)</span> <span class="o">=</span> <span class="kp">paste</span><span class="p">(</span>modNames<span class="p">,</span> <span class="s">&#39;.Cor.pvalue&#39;</span><span class="p">,</span> sep<span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
write.csv<span class="p">(</span><span class="kp">cbind</span><span class="p">(</span>geneModuleCor<span class="p">,</span> geneModulePvalue<span class="p">),</span>
    file<span class="o">=</span><span class="s">&#39;WGCNA_03_gene_module_relationship.csv&#39;</span><span class="p">)</span>

geneTraitCor <span class="o">=</span> cor<span class="p">(</span>expr<span class="p">,</span> traits<span class="p">,</span> use<span class="o">=</span><span class="s">&#39;p&#39;</span><span class="p">)</span>
geneTraitPvalue <span class="o">=</span> corPvalueStudent<span class="p">(</span>geneTraitCor<span class="p">,</span> nSamples<span class="p">)</span>
<span class="kp">names</span><span class="p">(</span>geneTraitCor<span class="p">)</span> <span class="o">=</span> <span class="kp">paste</span><span class="p">(</span><span class="kp">colnames</span><span class="p">(</span>traits<span class="p">),</span> <span class="s">&#39;.Cor&#39;</span><span class="p">,</span> sep<span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
<span class="kp">names</span><span class="p">(</span>geneTraitPvalue<span class="p">)</span> <span class="o">=</span> <span class="kp">paste</span><span class="p">(</span><span class="kp">colnames</span><span class="p">(</span>traits<span class="p">),</span> <span class="s">&#39;.Cor.pvalue&#39;</span><span class="p">,</span> sep<span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
write.csv<span class="p">(</span><span class="kp">cbind</span><span class="p">(</span>geneTraitCor<span class="p">,</span> geneTraitPvalue<span class="p">),</span>
    file<span class="o">=</span><span class="s">&#39;WGCNA_04_gene_trait_relationship.csv&#39;</span><span class="p">)</span>

module_aim <span class="o">=</span> <span class="s">&#39;blue&#39;</span>
trait_aim <span class="o">=</span> <span class="s">&#39;weight&#39;</span>
module_column <span class="o">=</span> <span class="kp">match</span><span class="p">(</span>module_aim<span class="p">,</span> modNames<span class="p">)</span>
trait_column <span class="o">=</span> <span class="kp">match</span><span class="p">(</span>trait_aim<span class="p">,</span> <span class="kp">colnames</span><span class="p">(</span>traits<span class="p">))</span>
geneModuleCorAim <span class="o">=</span> geneModuleCor<span class="p">[</span>moduleColors <span class="o">==</span> module_aim<span class="p">,</span> module_column<span class="p">]</span>
geneTraitCorAim <span class="o">=</span> geneTraitCor<span class="p">[</span>moduleColors <span class="o">==</span> module_aim<span class="p">,</span> trait_column<span class="p">]</span>
<span class="c1"># [visualization 10] 模块与基因表达量的相关性</span>
pdf<span class="p">(</span>file<span class="o">=</span><span class="kp">paste</span><span class="p">(</span><span class="s">&#39;visual_10_gene_significance_MM_in_&#39;</span><span class="p">,</span> module_aim<span class="p">,</span> <span class="s">&#39;.pdf&#39;</span><span class="p">,</span> sep<span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">))</span>
<span class="c1"># 这里应该也可以用labledHeatmap</span>
verboseScatterplot<span class="p">(</span><span class="kp">abs</span><span class="p">(</span>geneModuleCorAim<span class="p">),</span>
                    <span class="kp">abs</span><span class="p">(</span>geneTraitCorAim<span class="p">),</span>
                    xlab<span class="o">=</span><span class="kp">paste</span><span class="p">(</span><span class="s">&#39;Module Membership in&#39;</span><span class="p">,</span> module_aim<span class="p">,</span> <span class="s">&#39; module&#39;</span><span class="p">),</span>
                    ylab<span class="o">=</span><span class="kp">paste</span><span class="p">(</span><span class="s">&#39;Gene significance for&#39;</span><span class="p">,</span> trait_aim<span class="p">),</span>
                    main<span class="o">=</span><span class="kp">paste</span><span class="p">(</span><span class="s">&#39;Module membership (&#39;</span><span class="p">,</span> module_aim<span class="p">,</span> <span class="s">&#39;) vs Gene significance (&#39;</span><span class="p">,</span> trait_aim<span class="p">,</span> <span class="s">&#39;)&#39;</span><span class="p">),</span>
                    col <span class="o">=</span> module_aim<span class="p">)</span>
dev.off<span class="p">()</span>
</pre></div>


<h4 id="244">2.4.4 模块与模块内总体基因显著值</h4>
<p>“we define a gene significance variable as minus log10 of the univarite Cox regression pvalue for predicting survival on the basis of the gene epxression info“, 有文献定义了个gene significance, 然后可视化各个模块内该gene significance的分布情况。这说gen significance的分布情况。这说明gene significance是由我们自己定义的。我们这里使用每个基因的平均表达量作为其基因显著特征</p>
<div class="codehilite"><pre><span></span>exprPerGene <span class="o">=</span> <span class="kp">colMeans</span><span class="p">(</span>expr<span class="p">)</span>
<span class="c1"># [visualizaton 11] 模块与总体基因表达量柱状图</span>
pdf<span class="p">(</span>file<span class="o">=</span><span class="s">&#39;visual_11_total_geneSig_in_module.pdf&#39;</span><span class="p">)</span>
plotModuleSignificance<span class="p">(</span>exprPerGene<span class="p">,</span> moduleColors<span class="p">,</span> main<span class="o">=</span><span class="s">&quot;Module significance&quot;</span><span class="p">)</span>
dev.off<span class="p">()</span>
</pre></div>


<h4 id="245">2.4.5 各个模块内的基因表达模式图</h4>
<div class="codehilite"><pre><span></span>pdf<span class="p">(</span>file<span class="o">=</span><span class="kp">paste</span><span class="p">(</span><span class="s">&#39;visual_12_gene_expression_pattern_in_all_modules.pdf&#39;</span><span class="p">,</span> sep<span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">),</span> w<span class="o">=</span><span class="m">12</span><span class="p">,</span>h<span class="o">=</span><span class="m">9</span><span class="p">)</span>
<span class="kr">for</span><span class="p">(</span>moduleName <span class="kr">in</span> modNames<span class="p">)</span> <span class="p">{</span>
    column <span class="o">=</span> <span class="kp">match</span><span class="p">(</span>moduleName<span class="p">,</span> modNames<span class="p">)</span>
    sizeGrWindow<span class="p">(</span><span class="m">12</span><span class="p">,</span><span class="m">9</span><span class="p">)</span>
    par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
    par<span class="p">(</span>mar<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
    plotMat<span class="p">(</span><span class="kp">t</span><span class="p">(</span>expr<span class="p">[,</span> moduleColors <span class="o">==</span> moduleName<span class="p">]),</span>
            nrgcols<span class="o">=</span><span class="m">30</span><span class="p">,</span> clabels<span class="o">=</span><span class="kp">rownames</span><span class="p">(</span>traits<span class="p">));</span>
    par<span class="p">(</span>mar<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
    barplot<span class="p">(</span>MEs<span class="p">[,</span> column<span class="p">],</span> xlab <span class="o">=</span> moduleName<span class="p">,</span> ylab<span class="o">=</span><span class="s">&#39;Gene Expression pattern&#39;</span><span class="p">,</span> col<span class="o">=</span>moduleName<span class="p">)</span>
<span class="p">}</span>
dev.off<span class="p">()</span>
</pre></div>


<h4 id="246">2.4.6 模块内部基因连接性与基因显著的相关性</h4>
<p>这里的基因显著定义还是与2.4.4是一样的。</p>
<div class="codehilite"><pre><span></span>exprPerGene <span class="o">=</span> <span class="kp">colMeans</span><span class="p">(</span>expr<span class="p">)</span>
ConnectivityMeasure <span class="o">=</span> intramodularConnectivity<span class="p">(</span>adjacency<span class="p">,</span> moduleColors<span class="p">)</span>
pdf<span class="p">(</span>file<span class="o">=</span><span class="kp">paste</span><span class="p">(</span><span class="s">&#39;visual_13_intramodularConnect_gene_significance.pdf&#39;</span><span class="p">,</span> sep<span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">))</span>
<span class="kr">for</span><span class="p">(</span>moduleName <span class="kr">in</span> modNames<span class="p">)</span> <span class="p">{</span>
    verboseScatterplot<span class="p">(</span>ConnectivityMeasure<span class="o">$</span>kWithin<span class="p">[</span>moduleName <span class="o">==</span> moduleColors<span class="p">],</span>
                        exprPerGene<span class="p">[</span>moduleName <span class="o">==</span> moduleColors<span class="p">],</span>
                        col<span class="o">=</span>moduleColors<span class="p">[</span>moduleColors <span class="o">==</span> moduleName<span class="p">],</span>
                        main<span class="o">=</span><span class="kp">paste</span><span class="p">(</span><span class="s">&#39;module &#39;</span><span class="p">,</span> moduleName<span class="p">,</span> sep<span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">),</span>
                        ylab<span class="o">=</span><span class="s">&#39;Gene significance&#39;</span><span class="p">,</span>
                        xlab<span class="o">=</span><span class="s">&#39;Intramodular K&#39;</span><span class="p">)</span>
<span class="p">}</span>
dev.off<span class="p">()</span>
</pre></div>


<h3 id="25">2.5 导出数据</h3>
<div class="codehilite"><pre><span></span><span class="kp">load</span><span class="p">(</span><span class="s">&#39;01_sampleTree_cut_outlier.RData&#39;</span><span class="p">)</span>
<span class="kp">load</span><span class="p">(</span><span class="s">&#39;03_conn_adj_TOM.RData&#39;</span><span class="p">)</span>
<span class="kp">load</span><span class="p">(</span><span class="s">&#39;04_rawMEs_dissMEs_tree_mergedMEs.RData&#39;</span><span class="p">)</span>

<span class="c1"># softConnect, adjacency, TOM, geneTree,MEs, dissMEs_tree, mergedMEs</span>
probes <span class="o">=</span> <span class="kp">colnames</span><span class="p">(</span>expr<span class="p">)</span>
<span class="c1"># 想要导出的模块</span>
modules <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#39;green&#39;</span><span class="p">,</span> <span class="s">&#39;black&#39;</span><span class="p">)</span>
inModule <span class="o">=</span> <span class="kp">is.finite</span><span class="p">(</span><span class="kp">match</span><span class="p">(</span>mergedColors<span class="p">,</span> modules<span class="p">))</span>
modTOM <span class="o">=</span> TOM<span class="p">[</span>inModule<span class="p">,</span> inModule<span class="p">]</span>
modProbes <span class="o">=</span> probes<span class="p">[</span>inModule<span class="p">]</span>
<span class="kp">dimnames</span><span class="p">(</span>modTOM<span class="p">)</span> <span class="o">=</span> <span class="kt">list</span><span class="p">(</span>modProbes<span class="p">,</span> modProbes<span class="p">)</span>
IMConn <span class="o">=</span> softConnectivity<span class="p">(</span>expr<span class="p">[,</span> modProbes<span class="p">]);</span>

nTop <span class="o">=</span> <span class="m">30</span><span class="p">;</span>
top <span class="o">=</span> <span class="p">(</span><span class="kp">rank</span><span class="p">(</span><span class="o">-</span>IMConn<span class="p">)</span> <span class="o">&lt;=</span> nTop<span class="p">)</span>

cyt <span class="o">=</span> exportNetworkToCytoscape<span class="p">(</span>modTOM<span class="p">[</span>top<span class="p">,</span> top<span class="p">],</span>
        edgeFile<span class="o">=</span><span class="kp">paste</span><span class="p">(</span><span class="s">&#39;CytoscapeInput-edges-&#39;</span><span class="p">,</span> <span class="kp">paste</span><span class="p">(</span>modules<span class="p">,</span> collapse<span class="o">=</span><span class="s">&#39;-&#39;</span><span class="p">),</span> <span class="s">&#39;.txt&#39;</span><span class="p">,</span> sep<span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">),</span>
        nodeFile<span class="o">=</span><span class="kp">paste</span><span class="p">(</span><span class="s">&#39;CytoscapeInput-nodes-&#39;</span><span class="p">,</span> <span class="kp">paste</span><span class="p">(</span>modules<span class="p">,</span> collapse<span class="o">=</span><span class="s">&#39;-&#39;</span><span class="p">),</span> <span class="s">&#39;.txt&#39;</span><span class="p">,</span> sep<span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">),</span>
        weighted<span class="o">=</span><span class="bp">T</span><span class="p">,</span>
        threshold <span class="o">=</span> <span class="m">0.02</span><span class="p">,</span>
        nodeNames <span class="o">=</span> modProbes<span class="p">,</span>
        nodeAttr<span class="o">=</span>mergedColors<span class="p">[</span>inModule<span class="p">])</span>

vis <span class="o">=</span> exportNetworkToVisANT<span class="p">(</span>modTOM<span class="p">[</span>top<span class="p">,</span> top<span class="p">],</span>
                            file <span class="o">=</span> <span class="kp">paste</span><span class="p">(</span><span class="s">&quot;VisANTInput-&quot;</span><span class="p">,</span> module<span class="p">,</span> <span class="s">&quot;.txt&quot;</span><span class="p">,</span> sep<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">),</span>
                            weighted <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
                            threshold <span class="o">=</span> <span class="m">0</span><span class="p">,</span>
                            probeToGene <span class="o">=</span> <span class="kt">data.frame</span><span class="p">(</span>annot<span class="o">$</span>substanceBXH<span class="p">,</span> annot<span class="o">$</span>gene_symbol<span class="p">)</span> <span class="p">)</span>
</pre></div>
		</content>

	</main>
	<footer>
		<p> Powered by xizhihui </p>
		<p> Thanks to <a href="https://www.hifreud.com/">hifreud</a> the theme is learned from his site. </p>
	</footer>

<script type="text/javascript" src="/js/index.json"></script>
<script type="text/javascript" src="/js/category.json"></script>
<script type="text/javascript" src="/js/tags.json"></script>
<script type="text/javascript" src="/js/about.json"></script>
<script type="text/javascript" src="/js/index.js"></script>
<script type="text/javascript">
	// listen to click event on navigator in header
	// document
	// 	.querySelector("div#head_right ul")
	// 	.addEventListener("click", change_page)
	var table = [['h2', 'wgcna', '加权基因共表达网络分析(WGCNA)'], ['h3', '_1', '一、总述'], ['h4', '11-gcnawgcna', '1.1 相较于GCNA,WGCNA的优势'], ['h4', '12-wgcna', '1.2 相较于差异分析,WGCNA优势'], ['h4', '13', '1.3 基本术语'], ['h4', '14', '1.4 基本过程'], ['h3', '_2', '二、分析过程'], ['h3', '21', '2.1 导入数据、预处理'], ['h3', '22', '2.2 获取软阈值'], ['h3', '23', '2.3 构建网络'], ['h4', '233', '2.3.3 计算拓扑网络和内部连接性，基于此构建聚类树'], ['h4', '232', '2.3.2 把拓扑网络聚类树进行动态修剪，产生初始模块'], ['h4', '233_1', '2.3.3 计算模块特征，合并特征相似或靠近的模块，产生最终模块'], ['h3', '24', '2.4 关联分析'], ['h4', '241', '2.4.1 模块与模块相关性'], ['h4', '242', '2.4.2 模块与表型之间的相关性'], ['h4', '243', '2.4.3 模块与基因表达量相关性'], ['h4', '244', '2.4.4 模块与模块内总体基因显著值'], ['h4', '245', '2.4.5 各个模块内的基因表达模式图'], ['h4', '246', '2.4.6 模块内部基因连接性与基因显著的相关性'], ['h3', '25', '2.5 导出数据']]
	var html = format_article_table(table)
	var table_ele = document.querySelector("main #table")
	table_ele.innerHTML = html
	// window.onload = evt => resize_nav(table_ele)
	adaption(document, window)

</script>
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	<title>XZH's Notes</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="author" content="xizhihui" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="stylesheet" type="text/css" href="/statics/reset.css">
	<link rel="stylesheet" type="text/css" href="/statics/header_footer.css"></link>
	<link rel="stylesheet" type="text/css" href="/statics/default.css">
	<link rel="stylesheet" type="text/css" href="/statics/main.css">
</head>
<body>
	<header class="Header">
		<nav>
			<h3>XZH</h3>
			<ul>
				<li><a href="/index.html#Timeline">Timeline</a></li><li><a href="/index.html#Category">Category</a></li><li><a href="/index.html#Tags">Tags</a></li><li><a href="/index.html#About">About</a></li>
			</ul>
		</nav>
	</header>
	<div class="Motto">
		<h2>XZH's Notes</h2>
		<h4>The future comes for you ~ ~ ~</h4>
	</div>

	<main>
		<nav id="table"></nav>
		<content id="content" class="content">
			<h1 id="bowtie">Bowtie</h1>
<p>bowtie2是个超快的、内存占用少的序列比对工具，善于比对相对较长的基因组。bowtie2有gapped、pair-end和local比对模式，可以多线程进行。它是许多pipeline的首个步骤，例如变异检测，CHIP-seq，RNA-seq，BS-seq等等。
bowtie2不像常规目的的比对工具如MUMmer，Blast等。它在大的参考基因组的比对上表现更好，因为它针对当前各个测序平台的测序reads进行过优化。如果你的目的是比对很大的两个序列，比如基因组之间的比对，你应考虑使用MUMmer。如果你的目的是比对相对较短的序列如大肠杆菌的基因组，用bowtie2可以大大减少你的时间。</p>
<h2 id="1-bowtie1bowtie2">1. bowtie1和bowtie2的区别</h2>
<ul>
<li>对于长于50bp的序列,bowtie2速度更快也更灵敏，内存占用更少；但是Bowtie1在短于50bp的比对上有时会更快或更灵敏</li>
<li>bowtie2通过gap penalty支持gapped alignment</li>
<li>bowtie2支持局部比对(soft clipped, not end-to-end)</li>
<li>bowtie1的read length上限是1000bp，而bowtie2则没有上限</li>
<li>bowtie2支持参考基因组的跨Ns比对</li>
<li>对于pair-end reads,如果比对不上,bowtie2尝试将单个reads进行比对</li>
<li>bowtie2不支持colorspace reads的比对</li>
</ul>
<h2 id="2-getting-started">2. Getting started</h2>
<h3 id="21">2.1 对参考基因组建立索引</h3>
<div class="codehilite"><pre><span></span><span class="c1"># prefix是输出的索引文件前缀, .1.bt2, .2.bt2, .3.bt2, .4.bt2, .rev.1.bt2, .rev.2.bt2</span>
bowtie2-build path/to/ref.fa prefix
</pre></div>


<h3 id="22">2.2 进行比对</h3>
<div class="codehilite"><pre><span></span><span class="c1"># 对于单端测序(single end)</span>
bowtie2 -x prefix -U Single_end.fq -S align.sam &gt; align.log
<span class="c1"># 对于双端测序(paire-end)</span>
bowtie2 -x prefix -1 read1.fq -2 read2.fq -S align.sam &gt; align.log
<span class="c1"># 如果要使用局部比对模式</span>
bowtie2 --local -x prefix -U sigle_end.fq -S align.sam &gt; align.log
</pre></div>


<h3 id="23-indexreffa">2.3 从index里获取原始ref.fa</h3>
<div class="codehilite"><pre><span></span>bowtie2-inspect prefix
</pre></div>


<h2 id="3-index">3. 构建好的index下载</h2>
<table>
<tr><td>总卷 </td><td> 分卷</td></tr>

<tr><td><a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/hg18.zip">H. sapiens, UCSC hg18</a></td><td> <a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/hg18.1.zip">part1</a>, <a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/hg18.2.zip">part2</a>, <a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/hg18.3.zip">part3</a></td></tr>

<tr><td><a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/hg19.zip">H. sapiens, UCSC hg19</a> </td><td> <a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/hg19.1.zip">part1</a>, <a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/hg19.2.zip">part2</a>, <a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/hg19.3.zip">part3</a></td></tr>

<tr><td><a href="ftp://ftp.ncbi.nlm.nih.gov/genomes/archive/old_genbank/Eukaryotes/vertebrates_mammals/Homo_sapiens/GRCh38/seqs_for_alignment_pipelines/GCA_000001405.15_GRCh38_no_alt_analysis_set.fna.bowtie_index.tar.gz">H. sapiens, NCBI GRCh38</a></td><td> none</td></tr>

<tr><td><a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/mm10.zip">M. musculus, UCSC mm10</a> </td><td> <a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/mm10.1.zip">part1</a>, <a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/mm10.2.zip">part2</a>, <a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/mm10.3.zip">part3</a></td></tr>

<tr><td><a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/mm9.zip">M. musculus, UCSC mm9</a> </td><td> <a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/mm9.1.zip">part1</a>, <a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/mm9.2.zip">part2</a>, <a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/mm9.3.zip">part3</a></td></tr>
<tr><td><a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/rn4.zip">R. norvegicus, UCSC rn4</a> </td><td> <a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/rn4.1.zip">part1</a>, <a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/rn4.2.zip">part2</a>, <a href="ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/rn4.3.zip">part3</a></td></tr>
</table>

<h2 id="4-bowtie2">4. bowtie2相关术语解读</h2>
<h3 id="41">4.1 比对模式</h3>
<p>bowtie2里面有两种比对模式：end-to-end, local。前者在比对时要read的首尾比对上,中间没有比对上的作为gap进行罚分.而local比对模式在比对时，优先保证read内部而非两端的比对，就比对效果上看，local模式下的read两端没有比对上，类似切了两端，所以又称为soft clipped。</p>
<h3 id="42-scores-higher-more-similar">4.2 scores: higher = more similar</h3>
<p>比对得分指示着read与参考序列的相似性，得分越高相似性越高。比对得分的控制可以通过指定各个情况的得分实现。如下：</p>
<div class="codehilite"><pre><span></span>--ma:   match bonus,比对上的得分
--mp:   mismatch penalty,比对不上的罚分
--np:   read/ref序列中有N的罚分
--rdg:  affine <span class="nb">read</span> gap penalty,比对时read出现gap的罚分<span class="p">;</span>注意gap与mismatch的不同
--rfg:  affine reference gap penalty,比对时ref上出现gap的罚分
--score-min:    指定的最低得分,高于该得分的比对才算比对成功
</pre></div>


<h3 id="43-mapping-quality-higher-more-unique">4.3 mapping quality: higher = more unique</h3>
<p>比对质量指示着read比对到参考序列上的唯一性，得分越高，越是唯一比对。如果一个read有多种比对情况,那么某个比对情况score越高，我们就说这个比对越唯一。</p>
<h3 id="44-mixed-mode">4.4 mixed mode</h3>
<p>如果pair-end的reads比对不上，bowtie2会尝试使用单个read进行比对，这个情况称为mixed mode。这样的结果就是得到的比对率可能会比不使用该模式的比对率高辣么一点点。你可以指定--no-mixed参数禁用。</p>
<h3 id="45-reporting">4.5 reporting</h3>
<p>bowtie2有三种结果模式,默认模式是搜索多个比对情况,然后输出最佳比对。-a模式会搜索并输出所有比对情况。-k模式则是搜索1至多个比对情况，并输出。如果多个比对情况得分相同的话，bowtie2会随机选一个。</p>
		</content>

	</main>
	<footer>
		<p> Powered by xizhihui </p>
		<p> Thanks to <a href="https://www.hifreud.com/">hifreud</a> the theme is learned from his site. </p>
	</footer>

<script type="text/javascript" src="/js/index.json"></script>
<script type="text/javascript" src="/js/category.json"></script>
<script type="text/javascript" src="/js/tags.json"></script>
<script type="text/javascript" src="/js/about.json"></script>
<script type="text/javascript" src="/js/index.js"></script>
<script type="text/javascript">
	// listen to click event on navigator in header
	// document
	// 	.querySelector("div#head_right ul")
	// 	.addEventListener("click", change_page)
	var table = [['h2', '1-bowtie1bowtie2', '1. bowtie1和bowtie2的区别'], ['h2', '2-getting-started', '2. Getting started'], ['h3', '21', '2.1 对参考基因组建立索引'], ['h3', '22', '2.2 进行比对'], ['h3', '23-indexreffa', '2.3 从index里获取原始ref.fa'], ['h2', '3-index', '3. 构建好的index下载'], ['h2', '4-bowtie2', '4. bowtie2相关术语解读'], ['h3', '41', '4.1 比对模式'], ['h3', '42-scores-higher-more-similar', '4.2 scores: higher = more similar'], ['h3', '43-mapping-quality-higher-more-unique', '4.3 mapping quality: higher = more unique'], ['h3', '44-mixed-mode', '4.4 mixed mode'], ['h3', '45-reporting', '4.5 reporting']]
	var html = format_article_table(table)
	var table_ele = document.querySelector("main #table")
	table_ele.innerHTML = html
	// window.onload = evt => resize_nav(table_ele)
	adaption(document, window)

</script>
</body>
</html>
<!DOCTYPE html>
<html>
<head>
	<title>XZH's Notes</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="author" content="xizhihui" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="stylesheet" type="text/css" href="/statics/reset.css">
	<link rel="stylesheet" type="text/css" href="/statics/header_footer.css"></link>
	<link rel="stylesheet" type="text/css" href="/statics/default.css">
	<link rel="stylesheet" type="text/css" href="/statics/main.css">
</head>
<body>
	<header class="Header">
		<nav>
			<h3>XZH</h3>
			<ul>
				<li><a href="/index.html#Timeline">Timeline</a></li><li><a href="/index.html#Category">Category</a></li><li><a href="/index.html#Tags">Tags</a></li><li><a href="/index.html#About">About</a></li>
			</ul>
		</nav>
	</header>
	<div class="Motto">
		<h2>XZH's Notes</h2>
		<h4>The future comes for you ~ ~ ~</h4>
	</div>

	<main>
		<nav id="table"></nav>
		<content id="content" class="content">
			<h2 id="gokegg">GO/KEGG富集分析</h2>
<p>首先呢,要详细了解的话,需要看这篇文献(Ten Years of Pathway Analysis: Current Approaches and Outstanding Challenges),他把基本的信号通路分析方法进行了总结.
<img alt="pathway analysis" src="http://mmbiz.qpic.cn/mmbiz_png/I101ibe9h7rN70WJ0UyibFDgOfaFcUboddpTWZXoE778ibKe2MEdJgJ8qI4vaBHibfuDyNesJ7Ro9GYVNe9lJJNXibg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" /></p>
<h3 id="1ensembl-identrezid">1.对Ensembl ID进行转换,得到对应的基因名和EntrezID</h3>
<p>不同的物种要选择不同的数据库,不然选择不上.</p>
<ul>
<li>斑马鱼: <a href="http://www.bioconductor.org/packages/release/data/annotation/html/org.Dr.eg.db.html">org.Dr.eg.db</a></li>
<li>拟南芥: <a href="http://www.bioconductor.org/packages/release/data/annotation/html/org.At.tair.db.html">org.At.tair.db</a></li>
<li>小鼠: <a href="http://www.bioconductor.org/packages/release/data/annotation/html/org.Mm.eg.db.html">org.Mm.eg.db</a></li>
<li>大鼠: <a href="https://www.bioconductor.org/packages/release/data/annotation/html/org.Rn.eg.db.html">org.Rn.eg.db</a></li>
<li>人类: <a href="http://www.bioconductor.org/packages/release/data/annotation/html/org.Hs.eg.db.html">org.Hs.eg.db</a></li>
</ul>
<div class="codehilite"><pre><span></span><span class="kn">library</span><span class="p">(</span>org.Hs.eg.db<span class="p">)</span>
keytypes<span class="p">(</span>org.Hs.eg.db<span class="p">)</span>

<span class="c1"># ensids的ID类型与select函数的keytype要一致.如果是ENTREZID,就不用执行这一步.</span>
ensids <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#39;400212&#39;</span><span class="p">,</span> <span class="s">&#39;238240&#39;</span><span class="p">,</span> <span class="s">&#39;238204&#39;</span><span class="p">)</span>    
cols <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;SYMBOL&quot;</span><span class="p">,</span> <span class="s">&quot;GENENAME&quot;</span><span class="p">,</span> <span class="s">&#39;ENTREZID&#39;</span><span class="p">)</span>
gene <span class="o">=</span> select<span class="p">(</span>org.Hs.eg.db<span class="p">,</span> keys<span class="o">=</span>ensids<span class="p">,</span> columns<span class="o">=</span>cols<span class="p">,</span> keytype<span class="o">=</span><span class="s">&quot;ENSEMBL&quot;</span><span class="p">)</span>
</pre></div>


<h3 id="2">2. 进行注释</h3>
<p>同样的,OrgDb的参数数据库, 不同的物种要选择不同的数据库.</p>
<p>enrichKEGG的organism的参数要符合 http://www.genome.jp/kegg/catalog/org_list.html 所列.</p>
<div class="codehilite"><pre><span></span><span class="kn">library</span><span class="p">(</span>clusterProfiler<span class="p">)</span>

<span class="c1"># 1.cell category</span>
ego_CC <span class="o">&lt;-</span> enrichGO<span class="p">(</span>gene <span class="o">=</span> gene<span class="o">$</span>ENTREZID<span class="p">,</span> OrgDb<span class="o">=</span> org.Hs.eg.db<span class="p">,</span> ont <span class="o">=</span> <span class="s">&quot;CC&quot;</span><span class="p">,</span> pAdjustMethod <span class="o">=</span> <span class="s">&quot;BH&quot;</span><span class="p">,</span>
                   minGSSize <span class="o">=</span> <span class="m">1</span><span class="p">,</span> pvalueCutoff <span class="o">=</span> <span class="m">0.01</span><span class="p">,</span> qvalueCutoff <span class="o">=</span> <span class="m">0.01</span><span class="p">,</span> readable <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
<span class="c1"># 2.biological progress</span>
ego_BP <span class="o">&lt;-</span> enrichGO<span class="p">(</span>gene <span class="o">=</span> gene<span class="o">$</span>ENTREZID<span class="p">,</span> OrgDb<span class="o">=</span> org.Hs.eg.db<span class="p">,</span> ont <span class="o">=</span> <span class="s">&quot;BP&quot;</span><span class="p">,</span>
                   pAdjustMethod <span class="o">=</span> <span class="s">&quot;BH&quot;</span><span class="p">,</span> minGSSize <span class="o">=</span> <span class="m">1</span><span class="p">,</span>
                   pvalueCutoff <span class="o">=</span> <span class="m">0.01</span><span class="p">,</span> qvalueCutoff <span class="o">=</span> <span class="m">0.01</span><span class="p">,</span> readable <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
<span class="c1"># 3.molecular function</span>
ego_MF <span class="o">&lt;-</span> enrichGO<span class="p">(</span>gene <span class="o">=</span> gene<span class="o">$</span>ENTREZID<span class="p">,</span> OrgDb<span class="o">=</span> org.Hs.eg.db<span class="p">,</span> ont <span class="o">=</span> <span class="s">&quot;MF&quot;</span><span class="p">,</span>
                   pAdjustMethod <span class="o">=</span> <span class="s">&quot;BH&quot;</span><span class="p">,</span> minGSSize <span class="o">=</span> <span class="m">1</span><span class="p">,</span> pvalueCutoff <span class="o">=</span> <span class="m">0.01</span><span class="p">,</span>
                   qvalueCutoff <span class="o">=</span> <span class="m">0.01</span><span class="p">,</span> readable <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="c1"># 4.KEGG</span>
kk <span class="o">&lt;-</span> enrichKEGG<span class="p">(</span>gene <span class="o">=</span> gene<span class="o">$</span>ENTREZID<span class="p">,</span> organism <span class="o">=</span><span class="s">&quot;human&quot;</span><span class="p">,</span> pvalueCutoff <span class="o">=</span> <span class="m">0.01</span><span class="p">,</span>
                 qvalueCutoff <span class="o">=</span> <span class="m">0.01</span><span class="p">,</span> minGSSize <span class="o">=</span> <span class="m">1</span><span class="p">,</span>
                 <span class="c1">#readable = TRUE, </span>
                 use_internal_data <span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>

barplot<span class="p">(</span>kk<span class="p">,</span> showCategory<span class="o">=</span><span class="m">20</span><span class="p">,</span>title<span class="o">=</span><span class="s">&quot;EnrichmentGO_CC&quot;</span><span class="p">)</span>
dotplot<span class="p">(</span>kk<span class="p">,</span>title<span class="o">=</span><span class="s">&quot;EnrichmentGO_BP_dot&quot;</span><span class="p">)</span>
</pre></div>


<h4 id="23-gsea">2.3 GSEA富集分析</h4>
<div class="codehilite"><pre><span></span>gse <span class="o">&lt;-</span> gseGO<span class="p">(</span>gene <span class="o">=</span> gene<span class="o">$</span>ENTREZID<span class="p">,</span> ont <span class="o">=</span> <span class="s">&quot;BP&quot;</span><span class="p">,</span> 
            OrgDb <span class="o">=</span> org.Hs.eg.db<span class="p">,</span> keyType <span class="o">=</span> <span class="s">&quot;ENTREZID&quot;</span><span class="p">,</span> exponent <span class="o">=</span> <span class="m">1</span><span class="p">,</span>
            nPerm <span class="o">=</span> <span class="m">1000</span><span class="p">,</span> minGSSize <span class="o">=</span> <span class="m">10</span><span class="p">,</span> maxGSSize <span class="o">=</span> <span class="m">500</span><span class="p">,</span> pvalueCutoff <span class="o">=</span> <span class="m">0.05</span><span class="p">,</span>
            pAdjustMethod <span class="o">=</span> <span class="s">&quot;BH&quot;</span><span class="p">,</span> verbose <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> seed <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> by <span class="o">=</span> <span class="s">&quot;fgsea&quot;</span><span class="p">)</span>
</pre></div>


<h3 id="3">3.进行可视化</h3>
<div class="codehilite"><pre><span></span>results = c(ego_cc, ego_BP, ego_MF, kk)
names = c(&#39;GO enrich: CC&#39;, &#39;GO enrich: BP&#39;, &#39;GO_enrich_MF&#39;, &#39;KEGG enrich&#39;)
for (i in 1:length(results)) {
    barplot(results[i], showCategory=20,title=names[i])
    dotplot(results[i],title=names[i])
}

# GSEA plot
gseaplot(gse, geneSetID=&quot;GO:0004871&quot;)
</pre></div>
		</content>

	</main>
	<footer>
		<p> Powered by xizhihui </p>
		<p> Thanks to <a href="https://www.hifreud.com/">hifreud</a> the theme is learned from his site. </p>
	</footer>

<script type="text/javascript" src="/js/index.json"></script>
<script type="text/javascript" src="/js/category.json"></script>
<script type="text/javascript" src="/js/tags.json"></script>
<script type="text/javascript" src="/js/about.json"></script>
<script type="text/javascript" src="/js/index.js"></script>
<script type="text/javascript">
	// listen to click event on navigator in header
	// document
	// 	.querySelector("div#head_right ul")
	// 	.addEventListener("click", change_page)
	var table = [['h2', 'gokegg', 'GO/KEGG富集分析'], ['h3', '1ensembl-identrezid', '1.对Ensembl ID进行转换,得到对应的基因名和EntrezID'], ['h3', '2', '2. 进行注释'], ['h4', '23-gsea', '2.3 GSEA富集分析'], ['h3', '3', '3.进行可视化']]
	var html = format_article_table(table)
	var table_ele = document.querySelector("main #table")
	table_ele.innerHTML = html
	// window.onload = evt => resize_nav(table_ele)
	adaption(document, window)

</script>
</body>
</html>